/*
 *----------------------------------------------------------------------
 *    micro T-Kernel 3.00.00
 *
 *    Copyright (C) 2024 by Yuji Katori.
 *    This software is distributed under the T-License 2.2.
 *----------------------------------------------------------------------
 */

/*
 *	tft_driver.c
 */

#include <tk/tkernel.h>
#include <dev_tft.h>
#include "tft_config.h"
#include "iodefine.h"

#if TFT_CFG_DMA_CHANNEL == 0
#define TFT_DMAC	DMAC0
#elif TFT_CFG_DMA_CHANNEL == 1
#define TFT_DMAC	DMAC1
#elif TFT_CFG_DMA_CHANNEL == 2
#define TFT_DMAC	DMAC2
#elif TFT_CFG_DMA_CHANNEL == 3
#define TFT_DMAC	DMAC3
#elif TFT_CFG_DMA_CHANNEL == 4
#define TFT_DMAC	DMAC4
#elif TFT_CFG_DMA_CHANNEL == 5
#define TFT_DMAC	DMAC5
#elif TFT_CFG_DMA_CHANNEL == 6
#define TFT_DMAC	DMAC6
#else
#define TFT_DMAC	DMAC7
#endif

#define VPFP		( 6UL)				//   6 Line
#define	HPFP		( 2UL)				//   2 Pixel
#define VPBP		( 8UL)				//   8 Line
#define	HPBP		(37UL)				//  37 Pixel
#define BGPERI_FV	(VPFP+1+VPBP+BGVSIZE_VW+1)	// 288 Line
#define BGPERI_FH	(HPFP+4+HPBP+BGHSIZE_HW+2)	// 525 Pixel
#define BGVSIZE_VP	(VPFP+1+VPBP)			//  15 Line
#define BGVSIZE_VW	(272UL)				// 272 Line
#define BGHSIZE_HP	(HPFP+4+HPBP)			//  43 Pixel
#define BGHSIZE_HW	(480UL)				// 480 Pixel
#define VPWH		(1UL)				//   1 Line
#define	HPWH		(1UL)				//   1 Pixel
#define VW		(BGVSIZE_VW)			// 272 Line
#define HW		(BGHSIZE_HW)			// 480 Pixel

#pragma address frmbuf=0x00800000
LOCAL UH frmbuf[VW*2][HW];

LOCAL UB const ipagfont[][16] = {
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },	// ' '
#ifdef __LIT
	{ 0x00, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x00, 0x18, 0x18, 0x00, 0x00 },	// '!'
	{ 0x00, 0x6C, 0x6C, 0x24, 0x48, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },	// '"'
	{ 0x00, 0x24, 0x24, 0x24, 0x7E, 0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x7E, 0x24, 0x24, 0x24, 0x00 },	// '#'
	{ 0x00, 0x08, 0x1C, 0x6A, 0x4A, 0x48, 0x38, 0x18, 0x0E, 0x09, 0x49, 0x69, 0x3E, 0x0C, 0x08, 0x00 },	// '$'
	{ 0x00, 0x62, 0x92, 0x92, 0x94, 0x94, 0x98, 0x68, 0x16, 0x19, 0x29, 0x29, 0x49, 0x49, 0x46, 0x00 },	// '%'
	{ 0x00, 0x00, 0x38, 0x44, 0x44, 0x44, 0x28, 0x30, 0x7A, 0x4A, 0x46, 0x46, 0x3E, 0x00, 0x00, 0x00 },	// '&'
	{ 0x00, 0x60, 0x60, 0x20, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },	// '''
	{ 0x00, 0x04, 0x08, 0x10, 0x10, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x10, 0x10, 0x08, 0x04, 0x00 },	// '('
	{ 0x00, 0x20, 0x10, 0x08, 0x08, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x08, 0x08, 0x10, 0x20, 0x00 },	// ')'
	{ 0x00, 0x00, 0x00, 0x00, 0x18, 0x18, 0x5A, 0x34, 0x18, 0x34, 0x5A, 0x18, 0x00, 0x00, 0x00, 0x00 },	// '*'
	{ 0x00, 0x00, 0x00, 0x10, 0x10, 0x10, 0x10, 0x7E, 0x10, 0x10, 0x10, 0x10, 0x10, 0x00, 0x00, 0x00 },	// '+'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x30, 0x20, 0x60, 0x60, 0x40 },	// ','
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },	// '-'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x70, 0x70, 0x00, 0x00 },	// '.'
	{ 0x00, 0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x10, 0x10, 0x20, 0x20, 0x40, 0x40, 0x80, 0x00 },	// '/'
	{ 0x00, 0x00, 0x3C, 0x24, 0x46, 0x4A, 0x4A, 0x52, 0x52, 0x62, 0x62, 0x24, 0x3C, 0x00, 0x00, 0x00 },	// '0'
	{ 0x00, 0x00, 0x08, 0x38, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x00, 0x00, 0x00 },	// '1'
	{ 0x00, 0x00, 0x3C, 0x42, 0x42, 0x02, 0x06, 0x0C, 0x18, 0x30, 0x60, 0x40, 0xFE, 0x00, 0x00, 0x00 },	// '2'
	{ 0x00, 0x00, 0x3C, 0x62, 0x02, 0x02, 0x06, 0x1C, 0x02, 0x01, 0x41, 0x63, 0x3E, 0x00, 0x00, 0x00 },	// '3'
	{ 0x00, 0x00, 0x0C, 0x0C, 0x14, 0x34, 0x24, 0x44, 0xC4, 0xFF, 0x04, 0x04, 0x04, 0x00, 0x00, 0x00 },	// '4'
	{ 0x00, 0x00, 0x3E, 0x20, 0x20, 0x20, 0x7E, 0x67, 0x63, 0x01, 0x01, 0x62, 0x3C, 0x00, 0x00, 0x00 },	// '5'
	{ 0x00, 0x00, 0x1C, 0x22, 0x40, 0x40, 0x5C, 0x66, 0x42, 0x42, 0x42, 0x24, 0x1C, 0x00, 0x00, 0x00 },	// '6'
	{ 0x00, 0x00, 0x7E, 0x02, 0x04, 0x04, 0x0C, 0x08, 0x08, 0x18, 0x10, 0x10, 0x10, 0x00, 0x00, 0x00 },	// '7'
	{ 0x00, 0x00, 0x3C, 0x66, 0x42, 0x42, 0x24, 0x3C, 0x66, 0x42, 0x42, 0x66, 0x3C, 0x00, 0x00, 0x00 },	// '8'
	{ 0x00, 0x00, 0x3C, 0x24, 0x42, 0x42, 0x42, 0x66, 0x3E, 0x02, 0x02, 0x64, 0x38, 0x00, 0x00, 0x00 },	// '9'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x18, 0x00, 0x00, 0x00, 0x18, 0x18, 0x00, 0x00, 0x00 },	// ':'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x18, 0x00, 0x00, 0x00, 0x18, 0x18, 0x10, 0x10, 0x00 },	// ';'
	{ 0x00, 0x00, 0x02, 0x04, 0x08, 0x10, 0x20, 0x40, 0x40, 0x20, 0x10, 0x08, 0x04, 0x02, 0x00, 0x00 },	// '<'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7E, 0x00, 0x00, 0x7E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },	// '='
	{ 0x00, 0x00, 0x40, 0x20, 0x10, 0x08, 0x04, 0x02, 0x02, 0x04, 0x08, 0x10, 0x20, 0x40, 0x00, 0x00 },	// '>'
	{ 0x00, 0x3C, 0x66, 0x42, 0x42, 0x06, 0x04, 0x18, 0x18, 0x18, 0x18, 0x00, 0x18, 0x18, 0x00, 0x00 },	// '?'
	{ 0x00, 0x00, 0x3C, 0x46, 0x43, 0x9D, 0xA5, 0xA5, 0xA5, 0xAD, 0xBE, 0x40, 0x42, 0x3C, 0x00, 0x00 },	// '@'
	{ 0x00, 0x00, 0x18, 0x18, 0x18, 0x24, 0x24, 0x24, 0x3C, 0x42, 0x42, 0x42, 0xC3, 0x00, 0x00, 0x00 },	// 'A'
	{ 0x00, 0x00, 0x78, 0x46, 0x42, 0x42, 0x44, 0x78, 0x44, 0x42, 0x42, 0x46, 0x7C, 0x00, 0x00, 0x00 },	// 'B'
	{ 0x00, 0x00, 0x1C, 0x26, 0x42, 0x40, 0x40, 0x40, 0x40, 0x42, 0x42, 0x26, 0x1C, 0x00, 0x00, 0x00 },	// 'C'
	{ 0x00, 0x00, 0xF8, 0x44, 0x46, 0x42, 0x42, 0x42, 0x42, 0x42, 0x46, 0x44, 0xF8, 0x00, 0x00, 0x00 },	// 'D'
	{ 0x00, 0x00, 0x7E, 0x40, 0x40, 0x40, 0x40, 0x7C, 0x40, 0x40, 0x40, 0x40, 0x7E, 0x00, 0x00, 0x00 },	// 'E'
	{ 0x00, 0x00, 0x7E, 0x40, 0x40, 0x40, 0x40, 0x7C, 0x40, 0x40, 0x40, 0x40, 0x40, 0x00, 0x00, 0x00 },	// 'F'
	{ 0x00, 0x00, 0x38, 0x44, 0x86, 0x80, 0x80, 0x80, 0x8E, 0x82, 0x86, 0x46, 0x3A, 0x00, 0x00, 0x00 },	// 'G'
	{ 0x00, 0x00, 0x42, 0x42, 0x42, 0x42, 0x42, 0x7E, 0x42, 0x42, 0x42, 0x42, 0x42, 0x00, 0x00, 0x00 },	// 'H'
	{ 0x00, 0x00, 0x3C, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x3C, 0x00, 0x00, 0x00 },	// 'I'
	{ 0x00, 0x00, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x44, 0x44, 0x38, 0x00, 0x00, 0x00 },	// 'J'
	{ 0x00, 0x00, 0x44, 0x4C, 0x48, 0x58, 0x70, 0x78, 0x48, 0x4C, 0x44, 0x46, 0x46, 0x00, 0x00, 0x00 },	// 'K'
	{ 0x00, 0x00, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x7E, 0x00, 0x00, 0x00 },	// 'L'
	{ 0x00, 0x00, 0x66, 0x66, 0x66, 0x66, 0x66, 0x6A, 0x5A, 0x5A, 0x5A, 0x5A, 0x5A, 0x00, 0x00, 0x00 },	// 'M'
	{ 0x00, 0x00, 0x62, 0x62, 0x62, 0x52, 0x52, 0x5A, 0x4A, 0x4A, 0x46, 0x46, 0x46, 0x00, 0x00, 0x00 },	// 'N'
	{ 0x00, 0x00, 0x18, 0x24, 0x42, 0x42, 0x42, 0x42, 0x42, 0x42, 0x42, 0x24, 0x18, 0x00, 0x00, 0x00 },	// 'O'
	{ 0x00, 0x00, 0x7C, 0x46, 0x42, 0x42, 0x46, 0x7C, 0x40, 0x40, 0x40, 0x40, 0x40, 0x00, 0x00, 0x00 },	// 'P'
	{ 0x00, 0x00, 0x18, 0x24, 0x42, 0x42, 0x42, 0x42, 0x42, 0x42, 0x4A, 0x2C, 0x1C, 0x04, 0x00, 0x00 },	// 'Q'
	{ 0x00, 0x00, 0x7C, 0x46, 0x42, 0x42, 0x46, 0x7C, 0x48, 0x4C, 0x44, 0x44, 0x46, 0x00, 0x00, 0x00 },	// 'R'
	{ 0x00, 0x00, 0x3C, 0x46, 0x42, 0x40, 0x20, 0x18, 0x04, 0x02, 0x42, 0x62, 0x3C, 0x00, 0x00, 0x00 },	// 'S'
	{ 0x00, 0x00, 0x7E, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x00, 0x00, 0x00 },	// 'T'
	{ 0x00, 0x00, 0x42, 0x42, 0x42, 0x42, 0x42, 0x42, 0x42, 0x42, 0x42, 0x66, 0x3C, 0x00, 0x00, 0x00 },	// 'U'
	{ 0x00, 0x00, 0x42, 0x42, 0x66, 0x66, 0x24, 0x24, 0x24, 0x3C, 0x18, 0x18, 0x18, 0x00, 0x00, 0x00 },	// 'V'
	{ 0x00, 0x00, 0xDB, 0x5A, 0x5A, 0x5A, 0x5A, 0x5A, 0x66, 0x66, 0x66, 0x66, 0x24, 0x00, 0x00, 0x00 },	// 'W'
	{ 0x00, 0x00, 0x66, 0x24, 0x24, 0x3C, 0x18, 0x18, 0x18, 0x3C, 0x24, 0x66, 0x42, 0x00, 0x00, 0x00 },	// 'X'
	{ 0x00, 0x00, 0xC6, 0x44, 0x44, 0x28, 0x28, 0x38, 0x10, 0x10, 0x10, 0x10, 0x10, 0x00, 0x00, 0x00 },	// 'Y'
	{ 0x00, 0x00, 0x7E, 0x06, 0x04, 0x0C, 0x08, 0x18, 0x10, 0x30, 0x20, 0x60, 0x7E, 0x00, 0x00, 0x00 },	// 'Z'
	{ 0x00, 0x3E, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x3E, 0x00 },	// '['
	{ 0x00, 0x00, 0x42, 0x44, 0x2C, 0x28, 0x18, 0x7E, 0x10, 0x7E, 0x10, 0x10, 0x10, 0x10, 0x00, 0x00 },	// '\'
	{ 0x00, 0x7C, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x7C, 0x00 },	// ']'
	{ 0x00, 0x00, 0x18, 0x24, 0x42, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },	// '^'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7E },	// '_'
	{ 0x00, 0x00, 0x10, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },	// '`'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3C, 0x22, 0x02, 0x3E, 0x42, 0x46, 0x3A, 0x00, 0x00, 0x00 },	// 'a'
	{ 0x00, 0x00, 0x40, 0x40, 0x40, 0x40, 0x7C, 0x66, 0x42, 0x42, 0x42, 0x66, 0x3C, 0x00, 0x00, 0x00 },	// 'b'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3C, 0x66, 0x40, 0x40, 0x40, 0x66, 0x3C, 0x00, 0x00, 0x00 },	// 'c'
	{ 0x00, 0x00, 0x02, 0x02, 0x02, 0x02, 0x3E, 0x66, 0x42, 0x42, 0x42, 0x66, 0x3E, 0x00, 0x00, 0x00 },	// 'd'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3C, 0x66, 0x42, 0x7E, 0x40, 0x62, 0x3C, 0x00, 0x00, 0x00 },	// 'e'
	{ 0x00, 0x00, 0x1E, 0x10, 0x10, 0x10, 0x7E, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x00, 0x00, 0x00 },	// 'f'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3C, 0x66, 0x42, 0x42, 0x66, 0x3E, 0x02, 0x62, 0x3C, 0x00 },	// 'g'
	{ 0x00, 0x00, 0x40, 0x40, 0x40, 0x40, 0x7C, 0x62, 0x42, 0x42, 0x42, 0x42, 0x42, 0x00, 0x00, 0x00 },	// 'h'
	{ 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x00, 0x00, 0x00 },	// 'i'
	{ 0x00, 0x00, 0x08, 0x00, 0x00, 0x00, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x38 },	// 'j'
	{ 0x00, 0x00, 0x40, 0x40, 0x40, 0x40, 0x40, 0x4C, 0x58, 0x70, 0x78, 0x44, 0x46, 0x00, 0x00, 0x00 },	// 'k'
	{ 0x00, 0x00, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x1C, 0x00, 0x00, 0x00 },	// 'l'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7E, 0x52, 0x52, 0x52, 0x52, 0x52, 0x52, 0x00, 0x00, 0x00 },	// 'm'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x5C, 0x62, 0x42, 0x42, 0x42, 0x42, 0x42, 0x00, 0x00, 0x00 },	// 'n'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3C, 0x66, 0x42, 0x42, 0x42, 0x66, 0x3C, 0x00, 0x00, 0x00 },	// 'o'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7C, 0x66, 0x42, 0x42, 0x42, 0x66, 0x7C, 0x40, 0x40, 0x00 },	// 'p'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3A, 0x66, 0x42, 0x42, 0x42, 0x66, 0x3E, 0x02, 0x02, 0x00 },	// 'q'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x26, 0x38, 0x20, 0x20, 0x20, 0x20, 0x20, 0x00, 0x00, 0x00 },	// 'r'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x3C, 0x40, 0x60, 0x1C, 0x02, 0x02, 0x42, 0x3C, 0x00, 0x00, 0x00 },	// 's'
	{ 0x00, 0x00, 0x00, 0x00, 0x10, 0x10, 0x3C, 0x10, 0x10, 0x10, 0x10, 0x10, 0x1C, 0x00, 0x00, 0x00 },	// 't'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x42, 0x42, 0x42, 0x42, 0x42, 0x46, 0x3E, 0x00, 0x00, 0x00 },	// 'u'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x42, 0x66, 0x24, 0x24, 0x3C, 0x18, 0x18, 0x00, 0x00, 0x00 },	// 'v'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x5A, 0x5A, 0x5A, 0x5A, 0x66, 0x66, 0x24, 0x00, 0x00, 0x00 },	// 'w'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x66, 0x24, 0x3C, 0x18, 0x18, 0x24, 0x66, 0x00, 0x00, 0x00 },	// 'x'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x46, 0x44, 0x24, 0x2C, 0x38, 0x18, 0x18, 0x10, 0x10, 0x60 },	// 'y'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7E, 0x06, 0x0C, 0x18, 0x30, 0x60, 0x7E, 0x00, 0x00, 0x00 },	// 'z'
	{ 0x00, 0x06, 0x08, 0x08, 0x08, 0x08, 0x08, 0x18, 0x18, 0x08, 0x08, 0x08, 0x08, 0x08, 0x06, 0x00 },	// '{'
	{ 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10 },	// '|'
	{ 0x00, 0x60, 0x10, 0x10, 0x10, 0x10, 0x10, 0x18, 0x18, 0x10, 0x10, 0x10, 0x10, 0x10, 0x60, 0x00 },	// '}'
	{ 0x00, 0x20, 0x5A, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 } };	// '~'
#else
	{ 0x00, 0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x00, 0x24, 0x24, 0x00, 0x00 },	// '!'
	{ 0x00, 0x9C, 0x9C, 0x18, 0x84, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },	// '"'
	{ 0x00, 0x18, 0x18, 0x18, 0xBD, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0xBD, 0x18, 0x18, 0x18, 0x00 },	// '#'
	{ 0x00, 0x04, 0x2C, 0x95, 0x85, 0x84, 0x34, 0x24, 0x0D, 0x06, 0x86, 0x96, 0x3D, 0x0C, 0x04, 0x00 },	// '$'
	{ 0x00, 0x91, 0x61, 0x61, 0x68, 0x68, 0x64, 0x94, 0x29, 0x26, 0x16, 0x16, 0x86, 0x86, 0x89, 0x00 },	// '%'
	{ 0x00, 0x00, 0x34, 0x88, 0x88, 0x88, 0x14, 0x30, 0xB5, 0x85, 0x89, 0x89, 0x3D, 0x00, 0x00, 0x00 },	// '&'
	{ 0x00, 0x90, 0x90, 0x10, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },	// '''
	{ 0x00, 0x08, 0x04, 0x20, 0x20, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x20, 0x20, 0x04, 0x08, 0x00 },	// '('
	{ 0x00, 0x10, 0x20, 0x04, 0x04, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x04, 0x04, 0x20, 0x10, 0x00 },	// ')'
	{ 0x00, 0x00, 0x00, 0x00, 0x24, 0x24, 0xA5, 0x38, 0x24, 0x38, 0xA5, 0x24, 0x00, 0x00, 0x00, 0x00 },	// '*'
	{ 0x00, 0x00, 0x00, 0x20, 0x20, 0x20, 0x20, 0xBD, 0x20, 0x20, 0x20, 0x20, 0x20, 0x00, 0x00, 0x00 },	// '+'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x30, 0x10, 0x90, 0x90, 0x80 },	// ','
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xBD, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },	// '-'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xB0, 0xB0, 0x00, 0x00 },	// '.'
	{ 0x00, 0x01, 0x01, 0x02, 0x02, 0x04, 0x04, 0x04, 0x20, 0x20, 0x10, 0x10, 0x80, 0x80, 0x40, 0x00 },	// '/'
	{ 0x00, 0x00, 0x3C, 0x18, 0x89, 0x85, 0x85, 0xA1, 0xA1, 0x91, 0x91, 0x18, 0x3C, 0x00, 0x00, 0x00 },	// '0'
	{ 0x00, 0x00, 0x04, 0x34, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x00, 0x00, 0x00 },	// '1'
	{ 0x00, 0x00, 0x3C, 0x81, 0x81, 0x01, 0x09, 0x0C, 0x24, 0x30, 0x90, 0x80, 0xFD, 0x00, 0x00, 0x00 },	// '2'
	{ 0x00, 0x00, 0x3C, 0x91, 0x01, 0x01, 0x09, 0x2C, 0x01, 0x02, 0x82, 0x93, 0x3D, 0x00, 0x00, 0x00 },	// '3'
	{ 0x00, 0x00, 0x0C, 0x0C, 0x28, 0x38, 0x18, 0x88, 0xC8, 0xFF, 0x08, 0x08, 0x08, 0x00, 0x00, 0x00 },	// '4'
	{ 0x00, 0x00, 0x3D, 0x10, 0x10, 0x10, 0xBD, 0x9B, 0x93, 0x02, 0x02, 0x91, 0x3C, 0x00, 0x00, 0x00 },	// '5'
	{ 0x00, 0x00, 0x2C, 0x11, 0x80, 0x80, 0xAC, 0x99, 0x81, 0x81, 0x81, 0x18, 0x2C, 0x00, 0x00, 0x00 },	// '6'
	{ 0x00, 0x00, 0xBD, 0x01, 0x08, 0x08, 0x0C, 0x04, 0x04, 0x24, 0x20, 0x20, 0x20, 0x00, 0x00, 0x00 },	// '7'
	{ 0x00, 0x00, 0x3C, 0x99, 0x81, 0x81, 0x18, 0x3C, 0x99, 0x81, 0x81, 0x99, 0x3C, 0x00, 0x00, 0x00 },	// '8'
	{ 0x00, 0x00, 0x3C, 0x18, 0x81, 0x81, 0x81, 0x99, 0x3D, 0x01, 0x01, 0x98, 0x34, 0x00, 0x00, 0x00 },	// '9'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x24, 0x24, 0x00, 0x00, 0x00, 0x24, 0x24, 0x00, 0x00, 0x00 },	// ':'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x24, 0x24, 0x00, 0x00, 0x00, 0x24, 0x24, 0x20, 0x20, 0x00 },	// ';'
	{ 0x00, 0x00, 0x01, 0x08, 0x04, 0x20, 0x10, 0x80, 0x80, 0x40, 0x20, 0x04, 0x08, 0x01, 0x00, 0x00 },	// '<'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xBD, 0x00, 0x00, 0xBD, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },	// '='
	{ 0x00, 0x00, 0x80, 0x40, 0x20, 0x04, 0x08, 0x01, 0x01, 0x08, 0x04, 0x20, 0x10, 0x80, 0x00, 0x00 },	// '>'
	{ 0x00, 0x3C, 0x99, 0x81, 0x81, 0x09, 0x08, 0x24, 0x24, 0x24, 0x24, 0x00, 0x24, 0x24, 0x00, 0x00 },	// '?'
	{ 0x00, 0x00, 0x3C, 0x89, 0x83, 0x6E, 0x5A, 0x5A, 0x5A, 0x5E, 0x7D, 0x80, 0x81, 0x3C, 0x00, 0x00 },	// '@'
	{ 0x00, 0x00, 0x24, 0x24, 0x24, 0x18, 0x18, 0x18, 0x3C, 0x81, 0x81, 0x81, 0xC3, 0x00, 0x00, 0x00 },	// 'A'
	{ 0x00, 0x00, 0xB4, 0x89, 0x81, 0x81, 0x88, 0xB4, 0x88, 0x81, 0x81, 0x89, 0xBC, 0x00, 0x00, 0x00 },	// 'B'
	{ 0x00, 0x00, 0x2C, 0x19, 0x81, 0x80, 0x80, 0x80, 0x80, 0x81, 0x81, 0x19, 0x2C, 0x00, 0x00, 0x00 },	// 'C'
	{ 0x00, 0x00, 0xF4, 0x88, 0x89, 0x81, 0x81, 0x81, 0x81, 0x81, 0x89, 0x88, 0xF4, 0x00, 0x00, 0x00 },	// 'D'
	{ 0x00, 0x00, 0xBD, 0x80, 0x80, 0x80, 0x80, 0xBC, 0x80, 0x80, 0x80, 0x80, 0xBD, 0x00, 0x00, 0x00 },	// 'E'
	{ 0x00, 0x00, 0xBD, 0x80, 0x80, 0x80, 0x80, 0xBC, 0x80, 0x80, 0x80, 0x80, 0x80, 0x00, 0x00, 0x00 },	// 'F'
	{ 0x00, 0x00, 0x34, 0x88, 0x49, 0x40, 0x40, 0x40, 0x4D, 0x41, 0x49, 0x89, 0x35, 0x00, 0x00, 0x00 },	// 'G'
	{ 0x00, 0x00, 0x81, 0x81, 0x81, 0x81, 0x81, 0xBD, 0x81, 0x81, 0x81, 0x81, 0x81, 0x00, 0x00, 0x00 },	// 'H'
	{ 0x00, 0x00, 0x3C, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x00, 0x00, 0x00 },	// 'I'
	{ 0x00, 0x00, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x88, 0x88, 0x34, 0x00, 0x00, 0x00 },	// 'J'
	{ 0x00, 0x00, 0x88, 0x8C, 0x84, 0xA4, 0xB0, 0xB4, 0x84, 0x8C, 0x88, 0x89, 0x89, 0x00, 0x00, 0x00 },	// 'K'
	{ 0x00, 0x00, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0xBD, 0x00, 0x00, 0x00 },	// 'L'
	{ 0x00, 0x00, 0x99, 0x99, 0x99, 0x99, 0x99, 0x95, 0xA5, 0xA5, 0xA5, 0xA5, 0xA5, 0x00, 0x00, 0x00 },	// 'M'
	{ 0x00, 0x00, 0x91, 0x91, 0x91, 0xA1, 0xA1, 0xA5, 0x85, 0x85, 0x89, 0x89, 0x89, 0x00, 0x00, 0x00 },	// 'N'
	{ 0x00, 0x00, 0x24, 0x18, 0x81, 0x81, 0x81, 0x81, 0x81, 0x81, 0x81, 0x18, 0x24, 0x00, 0x00, 0x00 },	// 'O'
	{ 0x00, 0x00, 0xBC, 0x89, 0x81, 0x81, 0x89, 0xBC, 0x80, 0x80, 0x80, 0x80, 0x80, 0x00, 0x00, 0x00 },	// 'P'
	{ 0x00, 0x00, 0x24, 0x18, 0x81, 0x81, 0x81, 0x81, 0x81, 0x81, 0x85, 0x1C, 0x2C, 0x08, 0x00, 0x00 },	// 'Q'
	{ 0x00, 0x00, 0xBC, 0x89, 0x81, 0x81, 0x89, 0xBC, 0x84, 0x8C, 0x88, 0x88, 0x89, 0x00, 0x00, 0x00 },	// 'R'
	{ 0x00, 0x00, 0x3C, 0x89, 0x81, 0x80, 0x10, 0x24, 0x08, 0x01, 0x81, 0x91, 0x3C, 0x00, 0x00, 0x00 },	// 'S'
	{ 0x00, 0x00, 0xBD, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x00, 0x00, 0x00 },	// 'T'
	{ 0x00, 0x00, 0x81, 0x81, 0x81, 0x81, 0x81, 0x81, 0x81, 0x81, 0x81, 0x99, 0x3C, 0x00, 0x00, 0x00 },	// 'U'
	{ 0x00, 0x00, 0x81, 0x81, 0x99, 0x99, 0x18, 0x18, 0x18, 0x3C, 0x24, 0x24, 0x24, 0x00, 0x00, 0x00 },	// 'V'
	{ 0x00, 0x00, 0xE7, 0xA5, 0xA5, 0xA5, 0xA5, 0xA5, 0x99, 0x99, 0x99, 0x99, 0x18, 0x00, 0x00, 0x00 },	// 'W'
	{ 0x00, 0x00, 0x99, 0x18, 0x18, 0x3C, 0x24, 0x24, 0x24, 0x3C, 0x18, 0x99, 0x81, 0x00, 0x00, 0x00 },	// 'X'
	{ 0x00, 0x00, 0xC9, 0x88, 0x88, 0x14, 0x14, 0x34, 0x20, 0x20, 0x20, 0x20, 0x20, 0x00, 0x00, 0x00 },	// 'Y'
	{ 0x00, 0x00, 0xBD, 0x09, 0x08, 0x0C, 0x04, 0x24, 0x20, 0x30, 0x10, 0x90, 0xBD, 0x00, 0x00, 0x00 },	// 'Z'
	{ 0x00, 0x3D, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x3D, 0x00 },	// '['
	{ 0x00, 0x00, 0x81, 0x88, 0x1C, 0x14, 0x24, 0xBD, 0x20, 0xBD, 0x20, 0x20, 0x20, 0x20, 0x00, 0x00 },	// '\'
	{ 0x00, 0xBC, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0xBC, 0x00 },	// ']'
	{ 0x00, 0x00, 0x24, 0x18, 0x81, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },	// '^'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xBD },	// '_'
	{ 0x00, 0x00, 0x20, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },	// '`'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3C, 0x11, 0x01, 0x3D, 0x81, 0x89, 0x35, 0x00, 0x00, 0x00 },	// 'a'
	{ 0x00, 0x00, 0x80, 0x80, 0x80, 0x80, 0xBC, 0x99, 0x81, 0x81, 0x81, 0x99, 0x3C, 0x00, 0x00, 0x00 },	// 'b'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3C, 0x99, 0x80, 0x80, 0x80, 0x99, 0x3C, 0x00, 0x00, 0x00 },	// 'c'
	{ 0x00, 0x00, 0x01, 0x01, 0x01, 0x01, 0x3D, 0x99, 0x81, 0x81, 0x81, 0x99, 0x3D, 0x00, 0x00, 0x00 },	// 'd'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3C, 0x99, 0x81, 0xBD, 0x80, 0x91, 0x3C, 0x00, 0x00, 0x00 },	// 'e'
	{ 0x00, 0x00, 0x2D, 0x20, 0x20, 0x20, 0xBD, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x00, 0x00, 0x00 },	// 'f'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3C, 0x99, 0x81, 0x81, 0x99, 0x3D, 0x01, 0x91, 0x3C, 0x00 },	// 'g'
	{ 0x00, 0x00, 0x80, 0x80, 0x80, 0x80, 0xBC, 0x91, 0x81, 0x81, 0x81, 0x81, 0x81, 0x00, 0x00, 0x00 },	// 'h'
	{ 0x00, 0x00, 0x20, 0x00, 0x00, 0x00, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x00, 0x00, 0x00 },	// 'i'
	{ 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x34 },	// 'j'
	{ 0x00, 0x00, 0x80, 0x80, 0x80, 0x80, 0x80, 0x8C, 0xA4, 0xB0, 0xB4, 0x88, 0x89, 0x00, 0x00, 0x00 },	// 'k'
	{ 0x00, 0x00, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x2C, 0x00, 0x00, 0x00 },	// 'l'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xBD, 0xA1, 0xA1, 0xA1, 0xA1, 0xA1, 0xA1, 0x00, 0x00, 0x00 },	// 'm'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xAC, 0x91, 0x81, 0x81, 0x81, 0x81, 0x81, 0x00, 0x00, 0x00 },	// 'n'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3C, 0x99, 0x81, 0x81, 0x81, 0x99, 0x3C, 0x00, 0x00, 0x00 },	// 'o'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xBC, 0x99, 0x81, 0x81, 0x81, 0x99, 0xBC, 0x80, 0x80, 0x00 },	// 'p'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x35, 0x99, 0x81, 0x81, 0x81, 0x99, 0x3D, 0x01, 0x01, 0x00 },	// 'q'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x19, 0x34, 0x10, 0x10, 0x10, 0x10, 0x10, 0x00, 0x00, 0x00 },	// 'r'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x3C, 0x80, 0x90, 0x2C, 0x01, 0x01, 0x81, 0x3C, 0x00, 0x00, 0x00 },	// 's'
	{ 0x00, 0x00, 0x00, 0x00, 0x20, 0x20, 0x3C, 0x20, 0x20, 0x20, 0x20, 0x20, 0x2C, 0x00, 0x00, 0x00 },	// 't'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x81, 0x81, 0x81, 0x81, 0x81, 0x89, 0x3D, 0x00, 0x00, 0x00 },	// 'u'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x81, 0x99, 0x18, 0x18, 0x3C, 0x24, 0x24, 0x00, 0x00, 0x00 },	// 'v'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xA5, 0xA5, 0xA5, 0xA5, 0x99, 0x99, 0x18, 0x00, 0x00, 0x00 },	// 'w'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x99, 0x18, 0x3C, 0x24, 0x24, 0x18, 0x99, 0x00, 0x00, 0x00 },	// 'x'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x89, 0x88, 0x18, 0x1C, 0x34, 0x24, 0x24, 0x20, 0x20, 0x90 },	// 'y'
	{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xBD, 0x09, 0x0C, 0x24, 0x30, 0x90, 0xBD, 0x00, 0x00, 0x00 },	// 'z'
	{ 0x00, 0x09, 0x04, 0x04, 0x04, 0x04, 0x04, 0x24, 0x24, 0x04, 0x04, 0x04, 0x04, 0x04, 0x09, 0x00 },	// '{'
	{ 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20 },	// '|'
	{ 0x00, 0x90, 0x20, 0x20, 0x20, 0x20, 0x20, 0x24, 0x24, 0x20, 0x20, 0x20, 0x20, 0x20, 0x90, 0x00 },	// '}'
	{ 0x00, 0x10, 0xA5, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 } };	// '~'
#endif

SZ TFT_Write(SZ size, CONST VB *str)
{
LOCAL VB gr1, gr2, x, y;
INT i, j, bm;  SZ k;  VB c;

	for( k=0 ; ( c = *str++ ) != '\0' ; k++ )  {				// Null Code Loop
		if( size != 0 && k == size )					// Check Output Count(size)
			break;
		if( c >= ' ' && c <= '~' )  {					// SP <= Character <= ~
			for( i=0 ; i<16 ; i++ )  {				// Line Counts Loop
				bm = ipagfont[c-' '][i];			// Font BitMap Data --> bm
				for( j=0 ; j<8 ; j++ )  {			// Pixel Counts Loop
					frmbuf[y*16+i][x*8+j] = bm & 0x80 ? 0xFFFF : 0x0000;
					bm <<= 1;				// Wrtie Frame Buffer
				}
			}
			x ++ ;							// Increment X Position
		}
		else if( c == '\b' )  {						// Character is BS
			if( x )  x -- ;						// Decrement X Position
		}
		else if( c == '\t' )						// Character is TAB
			x += 8,  x &= 0xF8;					// Adjust X Position
		else if( c == '\r' )						// Character is LF
			x = 0;							// Adjust X Position
		else if( c == '\n' )						// Character is CR
			;							// Nothing
		else								// Other Code
			x ++ ;							// Increment X Position
		if( x == HW / 8 )						// X Position is Line Over ?
			c = '\n';						// Change Character Code
		if( c == '\n' )  {						// Line Change ?
			if( y == VW / 16 * 2 - 1 )				// Y Position is Max ?
				y = 0;						// Reset Y Position
			else							//
				y ++ ;						// Increment Y Position
			if( gr1 || gr2 || y >= VW / 16 )  {			// Scroll Area ?
				while( TFT_DMAC.DMCNT.BIT.DTE )  ;		// Wait Transfer End
				TFT_DMAC.DMDAR = frmbuf[y*16];			// Set Frame Buffer Address
				TFT_DMAC.DMCRA = sizeof(UH)*16*HW/sizeof(UW);	// Set Transfer Count
				TFT_DMAC.DMCNT.BIT.DTE = 1;			// Transfer Start
				if( y < VW / 16 )  {				// Upper Screen
					if( gr2 == VW / 16 )			// GR2 Position is Max ?
						gr2 = 0;			// Reset GR2 Position
					else					//
						gr2 ++ ;			// Increment GR2 Position
					GLCDC.GR2FLM2 += 16 * 480 * sizeof(UH);	// Set GR2 Frame Buffer Address
					GLCDC.GR2AB2.BIT.GRCVW -= 16;		// Decrement 16 Line
					if( ! GLCDC.GR2AB2.BIT.GRCVW )  {	// Nothing GR2 Area ?
						GLCDC.GR2AB2.BIT.GRCVS = VPBP + 1 + BGVSIZE_VW;	// Set GR1 GRCVS is 281 Line
						GLCDC.GR2FLM2 = (UW)frmbuf[VW];	// Reset GR2 Frame Buffer Address
					}					//
					GLCDC.GR1AB2.BIT.GRCVS -= 16;		// Decrement 16 Line
					GLCDC.GR1AB2.BIT.GRCVW += 16;		// Increment 16 Line
				}						//
				else  {						// Lower Screen
					if( gr1 == VW / 16 )			// GR1 Position is Max ?
						gr1 = 0;			// Reset GR1 Position
					else					//
						gr1 ++ ;			// Increment GR1 Position
					GLCDC.GR1FLM2 += 16 * 480 * sizeof(UH);	// Set GR1 Frame Buffer Address
					GLCDC.GR1AB2.BIT.GRCVW -= 16;		// Decrement 16 Line
					if( ! GLCDC.GR1AB2.BIT.GRCVW )  {	// Nothing GR1 Area ?
						GLCDC.GR1AB2.BIT.GRCVS = VPBP + 1 + BGVSIZE_VW;	// Set GR1 GRCVS is 281 Line
						GLCDC.GR1FLM2 = (UW)frmbuf[0];	// Reset GR1 Frame Buffer Address
					}					//
					GLCDC.GR2AB2.BIT.GRCVS -= 16;		// Decrement 16 Line
					GLCDC.GR2AB2.BIT.GRCVW += 16;		// Increment 16 Line
				}
				GLCDC.BGEN.BIT.VEN = 1;				// Enable Reflection of Register Value
			}
		}
	}
	return k;								// Return Actual Size

}

EXPORT void TFT_Init(void)
{
	tk_dis_dsp( );						// Dispatch Disable
	if( ! MSTP( GLCDC ) )  {				// GLCDC is Already Enable ?
		tk_ena_dsp( );					// Dispatch Enable
		return;						// GLCDC is Already Enable
	}
	SYSTEM.PRCR.WORD = 0xA502;				// Protect Disable
	MSTP( GLCDC ) = 0;					// Enable GLCDC
	MSTP( DMAC ) = 0;					// Enable DMAC
	SYSTEM.PRCR.WORD = 0xA500;				// Protect Enable
	tk_ena_dsp( );						// Dispatch Enable
	DMAC.DMAST.BIT.DMST = 1;				// DMA Master Enable
	TFT_DMAC.DMSAR = (void *)&ipagfont[2][12];		// Set All Black Data Address
	TFT_DMAC.DMDAR = frmbuf;				// Set Frame Buffer Address
	TFT_DMAC.DMCRA = sizeof(UH) * VW * HW / sizeof(UW);	// Set Transfer Count
	TFT_DMAC.DMTMD.WORD = 0x2200;				// Set Normal Transfer, Software
	TFT_DMAC.DMAMD.WORD = 0x0080;				// Set Src Fixed, Dst Increment
	TFT_DMAC.DMREQ.BYTE = 0x11;				// Software Transfer Start
	TFT_DMAC.DMCNT.BIT.DTE = 1;				// Transfer Start
	tk_dis_dsp( );						// Dispatch Disable
	MPC.PWPR.BIT.B0WI = 0;					// PFSWE Write Enable
	MPC.PWPR.BIT.PFSWE = 1;					// PmnPFS Write Enable
	MPC.PE7PFS.BYTE = 0x25;					// PE7 is LCD_DATA9-B
	MPC.PE6PFS.BYTE = 0x25;					// PE6 is LCD_DATA10-B
	MPC.PE5PFS.BYTE = 0x25;					// PE5 is LCD_DATA11-B
	MPC.PE4PFS.BYTE = 0x25;					// PE4 is LCD_DATA12-B
	MPC.PE3PFS.BYTE = 0x25;					// PE3 is LCD_DATA13-B
	MPC.PE2PFS.BYTE = 0x25;					// PE2 is LCD_DATA14-B
	MPC.PE1PFS.BYTE = 0x25;					// PE1 is LCD_DATA15-B
	MPC.PB5PFS.BYTE = 0x25;					// PB5 is LCD_CLK-B
	MPC.PB4PFS.BYTE = 0x25;					// PB4 is LCD_TCON0-B
	MPC.PB2PFS.BYTE = 0x25;					// PB2 is LCD_TCON2-B
	MPC.PB1PFS.BYTE = 0x25;					// PB1 is LCD_TCON3-B
	MPC.PB0PFS.BYTE = 0x25;					// PB0 is LCD_DATA0-B
	MPC.PA7PFS.BYTE = 0x25;					// PA7 is LCD_DATA1-B
	MPC.PA6PFS.BYTE = 0x25;					// PA6 is LCD_DATA2-B
	MPC.PA5PFS.BYTE = 0x25;					// PA5 is LCD_DATA3-B
	MPC.PA4PFS.BYTE = 0x25;					// PA4 is LCD_DATA4-B
	MPC.PA3PFS.BYTE = 0x25;					// PA3 is LCD_DATA5-B
	MPC.PA2PFS.BYTE = 0x25;					// PA2 is LCD_DATA6-B
	MPC.PA1PFS.BYTE = 0x25;					// PA1 is LCD_DATA7-B
	MPC.PA0PFS.BYTE = 0x25;					// PA0 is LCD_DATA8-B
	MPC.PWPR.BYTE = 0x80;					// Write Disable
	PORTE.PMR.BYTE |= 0xFE;					// PE7-PE1 is Peripheral Pin
	PORTA.PMR.BYTE = 0xFF;					// PA7-PA0 is Peripheral Pin
	PORTB.PMR.BYTE |= 0x37;					// PB5,PB4,PB2-PB0 is Peripheral Pin
	tk_ena_dsp( );						// Dispatch Enable
	GLCDC.BGEN.LONG = 0x00010000;				// Software Reset
	GLCDC.PANELCLK.LONG = 0x01100108;			// Use PLL, 8 Division (30MHz)
	GLCDC.PANELCLK.BIT.CLKEN = 1;				// Enable LCD_CLK Output
	while( ! GLCDC.BGMON.BIT.SWRST )  ;			// Wait Software Reset End
#ifdef __LIT
	GLCDC.OUTSET.LONG = 0x00002000;				// Set Data Format is RBG(565), Little Endian
#else
	GLCDC.OUTSET.LONG = 0x10002000;				// Set Data Format is RBG(565), Big Endian
#endif
	GLCDC.PANELDTHA.LONG = 0x00020000;
	GLCDC.BGPERI.LONG  = (  BGPERI_FV << 16 ) +  BGPERI_FH;	// FV is 288 Line,  FH is 525 Pixel
	GLCDC.BGSYNC.LONG  = (       VPFP << 16 ) +       HPFP;	// VP is   6 Line,  HP is   2 Pixel
	GLCDC.BGVSIZE.LONG = ( BGVSIZE_VP << 16 ) + BGVSIZE_VW;	// VP is  15 Line,  VW is 272 Line
	GLCDC.BGHSIZE.LONG = ( BGHSIZE_HP << 16 ) + BGHSIZE_HW;	// HP is  43 Pixel, HW is 480 Pixel
	GLCDC.TCONSTVA1.LONG = ( 0 << 16 ) + VPWH;		// VS is   0 Line, VW is   1 Line of STVA
	GLCDC.TCONSTVB1.LONG = ( ( BGVSIZE_VP - VPFP ) << 16 ) + BGVSIZE_VW;
								// VS is   9 Line, VW is 272 Line of STVB
	GLCDC.TCONSTVA2.LONG = ( 1 <<  4 ) + 1;			// LCD_TCON0 is Invert of STVA Signal (VSYNC)
	GLCDC.TCONSTHA1.LONG = ( 0 << 16 ) + HPWH;		// HS is   0 Pixel, HW is   1 Pixel of STHA
	GLCDC.TCONSTHB1.LONG = ( ( BGHSIZE_HP - HPFP ) << 16 ) + BGHSIZE_HW;
								// HS is  41 Pixel, HW is 480 Pixel of STHB
	GLCDC.TCONSTHA2.LONG = ( 1 <<  4 ) + 2;			// LCD_TCON2 is Invert of STHA Signal (HSYNC)
	GLCDC.TCONSTHB2.LONG = ( 0 <<  4 ) + 7;			// LCD_TCON3 is Normal of DE Signal (DE)
	GLCDC.BRIGHT1.LONG =   0x200;				// G Brightness Adjustment is 0
	GLCDC.BRIGHT2.LONG = ( 0x200 << 16 ) + 0x200;		// R, B Brightness Adjustment is 0
	GLCDC.CONTRAST.LONG = ( 0x80 << 16 ) + ( 0x80 << 8 ) + 0x80;	// Contrast Adjustment is All 1.00
	GLCDC.CLKPHASE.LONG = 0x00001000;			// Enable Contrast Adjustment
	while( TFT_DMAC.DMCNT.BIT.DTE )  ;			// Wait Frame Buffer Initialize End
	GLCDC.GR1FLM2 = (UW)frmbuf[0];				// Set GR1 Frame Buffer Address
	GLCDC.GR1FLM3.LONG = ( ( BGHSIZE_HW * 2 ) << 16 );	// Set GR1 Macro Line Offset
	GLCDC.GR1FLM5.LONG = ( ( BGVSIZE_VW - 1 ) << 16 ) + BGHSIZE_HW * 2 / 64 - 1;	// Set GR1 LNNUM is 271, DATANUM is 14
	GLCDC.GR1AB1.LONG = 0x00000002;				// Set Displays Current (GR1) Graphics
	GLCDC.GR1AB2.LONG = ( ( VPBP + 1 ) << 16 ) + BGVSIZE_VW;// Set GR1 GRCVS is  9 Line,  GRCVW is 272 Line
	GLCDC.GR1AB3.LONG = ( ( HPBP + 4 ) << 16 ) + BGHSIZE_HW;// Set GR1 GRCHS is 41 Pixel, GRCHW is 480 Pixel
	GLCDC.GR1FLMRD.LONG = 0x00000001;			// Enable Reading of GR1 Frame Buffer
	GLCDC.GR2FLM2 = (UW)frmbuf[VW];				// Set GR2 Frame Buffer Address
	GLCDC.GR2FLM3.LONG = ( ( BGHSIZE_HW * 2 ) << 16 );	// Set GR2 Macro Line Offset
	GLCDC.GR2FLM5.LONG = ( ( BGVSIZE_VW - 1 ) << 16 ) + BGHSIZE_HW * 2 / 64 - 1;	// Set GR2 LNNUM is 271, DATANUM is 14
	GLCDC.GR2AB1.LONG = 0x00000003;				// Set Displays Current (GR2) Graphics
	GLCDC.GR2AB2.LONG = ( ( VPBP + 1 + BGVSIZE_VW ) << 16 );// Set GR2 GRCVS is 281 Line,  GRCVW is   0 Line
	GLCDC.GR2AB3.LONG = ( ( HPBP + 4 ) << 16 ) + BGHSIZE_HW;// Set GR2 GRCHS is  41 Pixel, GRCHW is 480 Pixel
	GLCDC.GR2FLMRD.LONG = 0x00000001;			// Enable Reading of GR2 Frame Buffer
	GLCDC.BGEN.LONG = 0x00010101;				// Enable Background Generating Block Operation
	PORT6.PODR.BIT.B7 = 1;					// Set Output Value(Back Light ON)
	PORT6.PDR.BIT.B7 = 1;					// P67 is Output(Back Light Enable)
	PORTB.PODR.BIT.B3 = 1;					// Set Output Value(DISP ON)
	PORTB.PDR.BIT.B3 = 1;					// PB3 is Output(DISP Enable)
}